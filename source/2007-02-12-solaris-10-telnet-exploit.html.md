---
layout: post
title: The Solaris 10 telnet exploit
date: '2007-02-12'
author: Shawn Ferry
tags:
- solaris
- b.s.c.
modified_time: '2010-04-29T10:17:26.948-07:00'
blogger_id: tag:blogger.com,1999:blog-496684037280688885.post-8882708276170809859
blogger_orig_url: http://blog.shawnferry.com/2007/02/solaris-10-telnet-exploit.html
---

So at this point you have probably heard about the "0-day" telnet exploit
which appears to be a problem with user authentication with in.telnetd. I have
seen one proposed work around for the problem that I think may cause some
heartburn if implemented.  
  
In [Another Good Reason to Stop Using
Telnet](http://isc.sans.org/diary.html?storyid=2220) Donald Smith reports a
work around that appears to work. However in simple testing this appears to
break normal applications of telnet.  
e.g. if you ARE USING PASSWORD BASED USER AUTHENTICATION you will no longer be
able to login  
  
The mitigation of the vulnetability which allows logins as any user including
root to login without a password.  

    inetdadm -m svc:/network/telnet:default exec="/usr/sbin/in.telnetd -a user"  
    
I don't have a kerberos enabled environment to test with so I don't know if
ticket based authentication would still work in this configuration.  
  
My general thought process would be:  
  
If you are still using telnet, hopefully it is because you absolutely need to
use it.  
e.g. hard coded legacy application that uses telnet  
  
If you need to use telnet, enable tcp_wrappers  and allow only telnet from
your trusted and required hosts.

    inetdadm -m svc:/network/telnet:default tcp_wrappers=TRUE  
    
UPDATE 1 (02/13 9:48):

Interim Security Relief (ISRs)  Patches are available in the Sun Alert
document. The README does not seem to indicate that a reboot is required. If
you **need** telnet it would seem appropriate to install these patches ASAP.
(No really read the README, installing an IDR limits your ability to re-patch
the affected areas without first removing the IDR)

[**Sun Alert ID:
**102802](http://sunsolve.sun.com/search/document.do?assetkey=1-26-102802-1
"Security Vulnerability in the in.telnetd\(1M\) Daemon May Allow Unauthorized
Remote Users to Gain Access to a Solaris Host" ) Security Vulnerability in the
in.telnetd(1M) Daemon May Allow Unauthorized Remote Users to Gain Access to a
Solaris Host

[ US-CERT VU#881872](http://www.kb.cert.org/vuls/id/881872 "Sun Solaris telnet
authentication bypass vulnerability" ) Sun Solaris telnet authentication
bypass vulnerability

[  
](http://www.kb.cert.org/vuls/id/881872 "Sun Solaris telnet authentication
bypass vulnerability" )

